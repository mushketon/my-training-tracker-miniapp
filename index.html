<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–¢—Ä–µ–∫–µ—Ä –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ üí™</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--tg-theme-bg-color, #000000);
      color: var(--tg-theme-text-color, #ffffff);
      margin: 0;
      padding: 20px;
      text-align: center;
      min-height: 100vh;
      box-sizing: border-box;
    }
    h1 {
      margin: 0 0 20px;
      font-size: 28px;
    }
    #greeting {
      font-size: 18px;
      margin-bottom: 25px;
    }
    input, textarea {
      width: 100%;
      max-width: 500px;
      padding: 14px;
      margin: 12px 0;
      border-radius: 12px;
      border: 1px solid var(--tg-theme-hint-color, #888);
      background: var(--tg-theme-secondary-bg-color, #111);
      color: inherit;
      font-size: 16px;
      box-sizing: border-box;
    }
    textarea {
      resize: vertical;
      min-height: 120px;
    }
    button {
      padding: 16px 32px;
      font-size: 18px;
      margin: 12px 8px;
      border: none;
      border-radius: 12px;
      background: #0088cc;
      color: white;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover {
      background: #006699;
    }
  </style>
</head>
<body>

  <h1>üí™ –¢—Ä–µ–∫–µ—Ä –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h1>
  
  <div id="greeting">–ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</div>
  
  <input id="weight" type="text" placeholder="–¢–≤–æ–π –≤–µ—Å —Å–µ–≥–æ–¥–Ω—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: 78.5 –∫–≥)" />
  
  <textarea id="workout" placeholder="–ó–∞–ø–∏—à–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∑–¥–µ—Å—å:\n–ü—Ä–∏—Å–µ–¥ 4√ó10 90 –∫–≥\n–ñ–∏–º –ª–µ–∂–∞ 3√ó8 75 –∫–≥\n–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è 4√ómax\n..."></textarea>
  
  <div>
    <button onclick="saveAndSend()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <button onclick="Telegram.WebApp.close()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Mini App
    Telegram.WebApp.ready();
    Telegram.WebApp.expand(); // —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = Telegram.WebApp.initDataUnsafe?.user;
    const greetingEl = document.getElementById('greeting');

    if (user) {
      greetingEl.innerHTML = `
        –ü—Ä–∏–≤–µ—Ç, <b>\( {user.first_name || '–°–ø–æ—Ä—Ç—Å–º–µ–Ω'}</b> \){user.last_name ? ' ' + user.last_name : ''}! üëã<br>
        ID: ${user.id} ‚Ä¢ –Ø–∑—ã–∫: ${user.language_code || '?'} ‚Ä¢ –ü—Ä–µ–º–∏—É–º: ${user.is_premium ? '–î–∞ ‚≠ê' : '–ù–µ—Ç'}
      `;
    } else {
      greetingEl.textContent = '–ü—Ä–∏–≤–µ—Ç! –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å (–æ—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ Telegram)';
    }

    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–º—É Telegram (—Ç—ë–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è)
    const theme = Telegram.WebApp.themeParams;
    document.body.style.background = theme.bg_color || '#000000';
    document.body.style.color = theme.text_color || '#ffffff';

    // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
    function saveAndSend() {
      const weight = document.getElementById('weight').value.trim();
      const workout = document.getElementById('workout').value.trim();

      if (!weight && !workout) {
        Telegram.WebApp.showAlert('–ó–∞–ø–æ–ª–Ω–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø–æ–ª–µ!');
        return;
      }

      const message = `–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å –æ—Ç \( {user?.first_name || '–∞–Ω–æ–Ω–∏–º–∞'} ( \){new Date().toLocaleDateString('ru-RU')}):\n` +
                      (weight ? `–í–µ—Å: ${weight}\n` : '') +
                      (workout ? `\n–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:\n${workout}` : '');

      Telegram.WebApp.sendData(message);  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É –∫–∞–∫ —Å—Ç—Ä–æ–∫—É
      Telegram.WebApp.showAlert('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã! –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å.');
      Telegram.WebApp.close();
    }

    // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –±–æ–ª—å—à–∞—è –≥–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ Telegram –≤–Ω–∏–∑—É
    Telegram.WebApp.MainButton.setText('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±–æ—Ç—É');
    Telegram.WebApp.MainButton.show();
    Telegram.WebApp.MainButton.onClick(saveAndSend);
  </script>
</body>
</html>
